<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="u">
	<select id="user_list" resultType="users">
		select * from users
		order by join_date desc
	</select>
	
	
	<insert id="user_insert" parameterType="users">
		INSERT INTO Users (
		USER_ID,
		USER_NAME,
		ID,
		USER_PWD,
		USER_EMAIL,
		PHONE,
		BIRTH_DATE,
		JOIN_DATE
		) VALUES
		(
		users_seq.NEXTVAL,
		#{user_name},
		#{id},
		#{user_pwd},
		#{user_email},
		#{phone},
		TO_DATE(#{birth_date}, 'YYYY-MM-DD'),
		SYSDATE
		)
	</insert>



	<select id="Duplicate_check" parameterType="String"
		resultType="int">
		SELECT COUNT(*) FROM Users WHERE ID = #{id}
	</select>

<select id="select_id" parameterType="String" resultType="users">
    SELECT *
    FROM Users
    WHERE ID = #{id} <!-- id와 파라미터 이름 일치 -->
</select>

<!-- 이름과 이메일을 통한 id 조회 -->
<select id="findUserId" parameterType="users" resultType="String">
    SELECT id
    FROM Users
    WHERE user_name = #{user_name}
      AND user_email = #{user_email}
</select>


<!-- id와 이메일을 통한 비밀번호 조회   -->
<select id="findUserpwd" parameterType="users" resultType="String">
    SELECT user_pwd
    FROM Users
    WHERE id = #{id}
      AND user_email = #{user_email}
</select>

	<!-- 관리자 회원 한개 조회 -->
	<select id="user_detail" parameterType="int"
		resultType="users">
		select * from Users
		where user_Id=#{user_Id}
	</select>

	<!-- 관리자 회원 삭제 -->
	<delete id="user_admin_del" parameterType="users">
		delete from users
		where user_Id=#{user_Id}
	</delete>

	<update id="user_admin_update" parameterType="users">
	update users set
		id = #{id},
		user_name = #{user_name},
		phone = #{phone},
		user_email = #{user_email},
		lv = #{lv}
		where user_Id = #{user_Id}
	</update>

<!-- 제목으로 검색 -->
	<select id="user_search_by_title" resultType="users" parameterType="String">
	    SELECT * FROM users
	    WHERE user_name LIKE '%' || #{search_text} || '%'
	</select>
	
	<!-- 내용으로 검색 -->
	<select id="user_search_by_content" resultType="users" parameterType="String">
	    SELECT * FROM users
	    WHERE id LIKE '%' || #{search_text} || '%'
	</select>
	
	<!-- 전체 검색 -->
	<select id="user_search_by_all" resultType="users" parameterType="String">
	    SELECT * FROM users
	    WHERE user_name LIKE '%' || #{search_text} || '%'
	       OR id LIKE '%' || #{search_text} || '%'
	</select>

</mapper>























